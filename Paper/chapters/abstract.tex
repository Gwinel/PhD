%!TEX root =  ../main.tex

\begin{abstract}
	éšç€å¤šå¤„ç†å™¨æŠ€æœ¯çš„æ—¥è‡»æˆç†Ÿä»¥åŠé›†æˆåˆ°å•ä¸ªå¤„ç†å™¨ä¸Šçš„å¤„ç†å™¨æ ¸å¿ƒæ•°é‡çš„æ—¥è¶‹å¢åŠ ï¼Œè®¡ç®—æœºçš„è¿ç®—èƒ½åŠ›çš„ç“¶é¢ˆä¸æ–­è¢«æ‰“ç ´ï¼ŒåŒæ—¶è¿™ä¹Ÿä¸ºè®¾è®¡å…·æœ‰é«˜å¯æ‰©å±•æ€§çš„å¹¶å‘æ•°æ®ç»“æ„ä»¥åŠå¼€å‘åŸºäºå¤šæ ¸æ¶æ„çš„é«˜æ€§èƒ½è½¯ä»¶ç³»ç»Ÿæå‡ºäº†æŒ‘æˆ˜ã€‚
    å¹¶å‘å“ˆå¸Œè¡¨æ˜¯ä¸€ç§é‡è¦çš„å¹¶å‘æ•°æ®ç»“æ„ï¼Œå› å…¶å¤„ç†å…ƒç´ çš„å¼€é”€ä¸ºå¸¸æ•°æ—¶é—´çš„ç‰¹æ€§è¢«å¹¿æ³›åº”ç”¨äºå¤šæ ¸æ¶æ„çš„è½¯ä»¶ç³»ç»Ÿå¼€å‘ã€‚
    åœ¨å¹¶å‘å“ˆå¸Œè¡¨çš„è®¾è®¡ã€ä¼˜åŒ–ä»¥åŠåº”ç”¨ä¸­ï¼Œå¤„ç†å™¨çš„ä½“ç³»ç»“æ„ï¼Œç¼“å­˜ä¸€è‡´æ€§åè®®ï¼Œå†…å­˜å¸¦å®½ï¼Œå†…å­˜è®¿é—®å»¶è¿Ÿä»¥åŠå¤šçº¿ç¨‹çš„åŒæ­¥æœºåˆ¶éƒ½å¯¹å…¶æ€§èƒ½äº§ç”Ÿé‡å¤§å½±å“ã€‚
    æœ¬æ–‡é’ˆå¯¹åŸºäºå¤šæ ¸ç³»ç»Ÿçš„å¹¶å‘å“ˆå¸Œè¡¨åšäº†å¦‚ä¸‹å·¥ä½œï¼š

    é¦–å…ˆï¼Œè®¾è®¡äº†ç”¨äºå¹¶å‘å“ˆå¸Œè¡¨çš„æµ‹è¯•ã€è¯„ä¼°çš„ç»Ÿä¸€æµ‹è¯•æ¡†æ¶CHTBenchã€‚
    CHTBenchæ˜¯ç›®å‰å”¯ä¸€ä¸€ä¸ªä¸ºä¸åŒå¹¶å‘å“ˆå¸Œè¡¨ä¹‹é—´è¿›è¡Œæ€§èƒ½æ¯”è¾ƒï¼Œè¯„ä¼°è€Œè®¾è®¡çš„ä¿è¯å…¬å¹³æ€§çš„æµ‹è¯•æ¡†æ¶ã€‚
    å®ƒæä¾›ç»Ÿä¸€çš„æµ‹è¯•æ¥å£ï¼Œå…·æœ‰å¯é…ç½®çš„çº¿ç¨‹ä¸æ ¸çš„æ˜ å°„å…³ç³»ï¼Œèƒ½å¤Ÿæµ‹è¯•ä¸åŒè§„æ¨¡çš„æ•°æ®é›†ä»¥åŠæ•°æ®é›†ä¸­æ›´æ–°æ“ä½œçš„æ¯”é‡ç­‰ã€‚
    æ­¤å¤–ï¼ŒCHTBenchä½¿ç”¨$sspfd$è¿›è¡Œå»¶è¿Ÿçš„æµ‹ç®—ï¼Œç»¼åˆè€ƒå¯Ÿä¸åŒå¹¶å‘å“ˆå¸Œè¡¨çº¿ç¨‹æ‰©å±•æ€§ï¼ŒæŸ¥è¯¢å’Œæ›´æ–°æ€§èƒ½ï¼Œå„ç§æ“ä½œç±»å‹çš„å»¶è¿Ÿç­‰å®è§‚æŒ‡æ ‡ã€‚
    è¿˜å¯ä»¥ç»“åˆå…¶å®ƒçš„å·¥å…·å¦‚$likwid$å¯¹ç¼“å­˜å‘½ä¸­ç‡ï¼Œå†…å­˜å¸¦å®½ï¼Œè·¨å†…å­˜èŠ‚ç‚¹é€šä¿¡å¼€é”€ç­‰å¾®è§‚æŒ‡æ ‡è¿›è¡Œåˆ†æã€‚
    ä½¿ç”¨CHTBenchå¯ä»¥ä¸ºå¹¶å‘å“ˆå¸Œè¡¨çš„è¯„ä¼°å’Œæ¯”è¾ƒæä¾›ç›¸å¯¹å…¬å¹³çš„æµ‹è¯•ç¯å¢ƒã€‚

    ç¬¬äºŒï¼ŒåŸºäºCHTBenchæµ‹è¯•æ¡†æ¶å¯¹ç°æœ‰çš„å‡ ç§å…·æœ‰ä»£è¡¨æ€§çš„å¹¶å‘å“ˆå¸Œè¡¨åœ¨å››ä¸ªä¸åŒçš„å¤šæ ¸ç³»ç»Ÿä¸Šè¿›è¡Œäº†æ·±å…¥çš„å‰–æã€‚
    å¯¹å¹¶å‘å“ˆå¸Œè¡¨çš„è¯„ä¼°é€‰ç”¨çš„æ€§èƒ½æŒ‡æ ‡æ¶µç›–å®è§‚å’Œå¾®è§‚ä¸¤ä¸ªå±‚é¢ï¼ŒåŒ…æ‹¬ååé‡çš„çº¿ç¨‹æ‰©å±•æ€§ï¼Œå»¶è¿Ÿï¼Œåˆ†å±‚å†…å­˜ç»“æ„å¯¹æ€§èƒ½çš„å½±å“ï¼Œä¸åŒçº¿ç¨‹ä¸æ ¸æ˜ å°„æ–¹å¼ä¹‹é—´çš„æ€§èƒ½å·®å¼‚ï¼ŒåŒæ­¥æœºåˆ¶çš„æ€§èƒ½è¯„ä¼°ä»¥åŠå†…å­˜æ¶ˆè€—ã€‚
    é€šè¿‡å¯¹ä¸Šè¿°æŒ‡æ ‡çš„åˆ†æï¼Œæ‰¾å‡ºç°æœ‰å¹¶å‘å“ˆå¸Œè¡¨è®¾è®¡æ–¹æ³•ä¸­å­˜åœ¨çš„é—®é¢˜ä»¥åŠå¯èƒ½çš„æ€§èƒ½ç“¶é¢ˆï¼Œåˆ†ææ€»ç»“äº†8æ¡è®¾è®¡ã€ä¼˜åŒ–å¹¶å‘å“ˆå¸Œè¡¨çš„æœ€ä½³å®è·µåŸåˆ™ï¼Œä¸ºå°†æ¥è¿›ä¸€æ­¥è®¾è®¡åŸºäºå¤šæ ¸ç³»ç»Ÿçš„å…·æœ‰é«˜å¯æ‰©å±•æ€§çš„å¹¶å‘å“ˆå¸Œè¡¨å¥ å®šç†è®ºå’Œå®è·µåŸºç¡€ã€‚
    æ ¹æ®å¯¹æ¯”ç°æœ‰æ–‡çŒ®ä»¥åŠç›¸å…³ç ”ç©¶å·¥ä½œï¼Œæˆ‘ä»¬å¯¹äºå¹¶å‘å“ˆå¸Œè¡¨çš„è¯„ä¼°æ–¹æ³•å’Œæ‰€æ¶‰åŠçš„è¯„ä¼°æŒ‡æ ‡æ˜¯è¿„ä»Šä¸ºæ­¢æœ€å…¨é¢çš„ã€‚

    ç¬¬ä¸‰ï¼Œä½¿ç”¨Intelé™åˆ¶æ€§äº‹åŠ¡å†…å­˜ï¼ˆRTMï¼‰å®ç°äº†åŸºäºç¡¬ä»¶äº‹åŠ¡å†…å­˜ï¼ˆHTMï¼‰çš„ç¼“å­˜è¡Œå“ˆå¸Œè¡¨ã€‚
    ä½¿ç”¨å…¨å±€é”å®ç°äº†å¤šçº¿ç¨‹å¹¶å‘ï¼Œå®éªŒè¯„ä¼°ç»“æœè¡¨æ˜ï¼Œå½“æ•°æ®é›†çš„è§„æ¨¡å¤§äºæœ€åä¸€çº§ç¼“å­˜å®¹é‡æ—¶ï¼ŒåŸºäºHTMçš„ç¼“å­˜è¡Œå“ˆå¸Œè¡¨çš„æ€§èƒ½æ˜¯ä½¿ç”¨ä¼ ç»Ÿçš„ç»†ç²’åº¦é”æ–¹æ³•å®ç°çš„ç¼“å­˜è¡Œå“ˆå¸Œè¡¨çš„120\%ã€‚
    ä½¿ç”¨ç¡¬ä»¶äº‹åŠ¡å†…å­˜è¿›è¡Œå¹¶å‘å“ˆå¸Œè¡¨çš„è®¾è®¡çœŸæ­£åšåˆ°äº†ç²—ç²’åº¦é”æ–¹æ³•çš„ç®€ä¾¿ä¸ç»†ç²’åº¦é”æ–¹æ³•çš„é«˜æ€§èƒ½çš„æœ‰æœºç»“åˆã€‚
    åŒæ—¶ï¼Œä¸ºäº†æ¶ˆé™¤Intel TSXçš„Lemmingæ•ˆåº”å¯¹æ€§èƒ½çš„å½±å“ï¼Œè®¾è®¡äº†ä¸¤ç§è½¯ä»¶è¾…åŠ©æ–¹æ³•ï¼šè½¯ä»¶è¾…åŠ©çš„é”çœç•¥æ–¹æ³•ï¼ˆSLRï¼‰å’Œè½¯ä»¶è¾…åŠ©çš„å†²çªç®¡ç†æ–¹æ³•ï¼ˆSCMï¼‰ã€‚
    å®éªŒç»“æœè¡¨æ˜ï¼Œè¿™ä¸¤ç§æ–¹æ³•å¯¹åŸºäºHTMçš„å¹¶å‘å“ˆå¸Œè¡¨æ€§èƒ½çš„æå‡æ¯”Intelå®˜æ–¹æ¨èçš„RTM Retryæœºåˆ¶æ›´æ˜æ˜¾ã€‚

    æœ€åï¼Œä½¿ç”¨ä¸å®Œæ•´é”®Cuckooå“ˆå¸Œæ–¹æ³•è®¾è®¡å¹¶å®ç°äº†æ”¯æŒå¤šçº¿ç¨‹å¹¶å‘çš„Cuckooè¿‡æ»¤å™¨ã€‚
    è¿™æ˜¯ç›®å‰ä¸ºæ­¢å”¯ä¸€ä¸€æ¬¾æ”¯æŒå¤šçº¿ç¨‹å¹¶å‘çš„è¿‡æ»¤å™¨å®ç°ï¼ŒåŒæ—¶ä¹Ÿæ˜¯å”¯ä¸€ä¸€æ¬¾åŸºäºç¡¬ä»¶äº‹åŠ¡å†…å­˜çš„è¿‡æ»¤å™¨ã€‚
    åŸå§‹çš„å¸ƒéš†è¿‡æ»¤å™¨ä¸æ”¯æŒåˆ é™¤æ“ä½œï¼Œå®ç°åˆ é™¤æ“ä½œéœ€è¦å¼•å…¥é¢å¤–çš„ç©ºé—´å¼€é”€ï¼ŒCuckooå“ˆå¸Œå¼•å…¥æŒ‡çº¹ä¿¡æ¯æŠ€æœ¯å®ç°äº†åˆ é™¤æ“ä½œï¼Œä¸é¢å¤–å¢åŠ è¿‡æ»¤å™¨çš„ç©ºé—´å¼€é”€ã€‚
    ä½¿ç”¨åŸºäºIntel RTMçš„è¯»å†™é”å®ç°äº†å¤šçº¿ç¨‹å¹¶å‘çš„Cuckooè¿‡æ»¤å™¨ã€‚
    å®éªŒè¯„ä¼°è¡¨æ˜ï¼Œå¹¶å‘Cuckooè¿‡æ»¤å™¨çš„åˆå§‹åŒ–é€Ÿåº¦æ˜¯ä½¿ç”¨å•ä¸ªçº¿ç¨‹åˆå§‹åŒ–çš„10å€ï¼ŒæŸ¥è¯¢æ“ä½œçš„æ€§èƒ½æ˜¯å•ä¸ªçº¿ç¨‹çš„38å€ï¼Œå¤„ç†æ›´æ–°å 10\%çš„æ•°æ®é›†çš„æ€§èƒ½æ˜¯å•ä¸ªçº¿ç¨‹çš„11å€ã€‚
    æ­¤å¤–ï¼Œè¿˜å¯¹$retry$çš„æœ€å¤§å€¼å¦‚ä½•é€‰å–ä»¥åŠä½¿ç”¨ä¸åŒè½¯ä»¶ä¼˜åŒ–æ–¹æ³•çš„Cuckooè¿‡æ»¤å™¨ç‰ˆæœ¬è¿›è¡Œäº†çº¿ç¨‹æ‰©å±•æ€§çš„æ¯”è¾ƒã€‚

    
  	\keywords{å¤šæ ¸ç³»ç»Ÿï¼›å¹¶å‘å“ˆå¸Œè¡¨ï¼›å¸ƒéš†è¿‡æ»¤å™¨ï¼›åŒæ­¥ï¼›éä¸€è‡´æ€§å†…å­˜æ¶æ„ï¼›ç¡¬ä»¶äº‹åŠ¡å†…å­˜}
\end{abstract}

\begin{enabstract}
	 As the development of multi-processor techniques and the increasing of the number of cores integrated into a single CPU chip the bottleneck of computing power of the processor is constantly being broken. 
	 It also makes designing highly scalable concurrency data structures and developing high-performance software systems based on multi-core architectures more complicated.
	 Concurrent hash table(CHT) is an important concurrent data structure and it is widely used to implement software systems on multi-core architectures as its queries run in amortized constant time.
	 The hardware architecture, cache coherence protocol, memory bandwidth, memory access latency and multi-thread synchronization mechanism impact the designing, optimization and application of CHT significantly.
     The works of this paper including:

     First, we present a framework, named CHTBench, which provides a fair testing environment and unified interface for the experiments by hiding the discrepancies of hardware platforms, synthesized workloads, concurrency models, and compiler configurations. 
     In this way, we can guarantee the experimental results generated from our framework are fairly comparable between different CHTs. 
     An open source library, $sspfd$, is integrated into CHTBench to measure the access latency of different kinds of operations.
     With CHTBench it's easy to compare the performance of CHTs. And it can also combine with other system tools such as $likwid$ to measure cache hit/miss rate, memory bandwidth overheads and cross-socket node communication overheads from micro perspective.
    
     Second, we dissected 5 state of the art CHTs on CHTBench. The evaluations are explored from a wide range of perspectives including thread scalability, throughput, latency, memory hierarchy impact, low-level synchronization primitives, and memory usage. The inter-correlations between relevant metrics are also discussed when necessary. The experiments are conducted on four major hardware platforms including Intel Many Integrated Core(MIC) architecture and three representative Non-uniform Memory Architecture(NUMA) systems. We ported CHTs to the MIC platform, and to our knowledge, this is the first extensive study of concurrent hash tables on Intel MIC architecture. 
     According to the experimental results, Œeight principles of best practices in designing and optimizing concurrent hash tables are summarized which lay the theoretical and practical foundation for further design of high scalability concurrent hash tables based on multi-core systems in the future. 


    Then, implemented a concurrent cache-line hash table with hardware transactional memory(HTM-based CLHT).
    The HTM-based CLHT takes the whole hash table as the critical section to achieve multi-threaded concurrency. 
    When running workloads which large than the capacity of LLC, its performance is twenty percent better than using traditional fine-grained locks. 
    Designing CHT achieves the combination of simplicity of coarse-grained locking and high-performance of fine-grained locking.
    In order to eliminate the Lemming effect of Intel TSX, we presented two software-assisted techniques, lock removal(SLR) and conflict management(SCM).
    Both of these methods improve the performance of the HTM-based concurrent hash table more significantly than the RTM Retry mechanism recommended by Intel.

    At last, we presented a concurrent Cuckoo Filter based on partial-key Cuckoo Hashing.
    To our knowledge, this is the only concurrent filter so far, and its also the only one which based on hardware transactional memory(HTM).
    The standard Bloom Filter do not support delete elements from filter, while other extended versions of Bloom Filter support the deletion of filters with high space overheads.
    The structure of Cuckoo Hashing is in a set-associative way, each element can map to several slots.
    Taking this feature of Cuckoo hash table, we extract the fingerprints of the members of a set and store them in a hash table. 
    This can delete an element very easy and without any additional space overheads.
    When running with read-only workloads, the max throughput is 38 times of the throughput of a single thread, and running workloads with ten percent update operations, the max throughput is 11 times of a single thread.



  	\enkeywords{Multi-core System; Concurrent Hash Table; Synchronization; Non-uniform Memory Architecture; Hardware Transactional Memory}
\end{enabstract}